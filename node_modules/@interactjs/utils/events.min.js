import{contains as e}from"./arr.min.js";import*as t from"./domUtils.min.js";import*as s from"./is.min.js";import n from"./pointerExtend.min.js";import*as o from"./pointerUtils.min.js";const r=[],i=[],l={},p=[];function a(t,s,n,o){const l=f(o);let p=r.indexOf(t),a=i[p];a||(a={events:{},typeCount:0},p=r.push(t)-1,i.push(a)),a.events[s]||(a.events[s]=[],a.typeCount++),t.removeEventListener&&!e(a.events[s],n)&&(t.addEventListener(s,n,m.supportsOptions?l:!!l.capture),a.events[s].push(n))}function c(e,t,s,n){const o=f(n),l=r.indexOf(e),p=i[l];if(p&&p.events)if("all"!==t){if(p.events[t]){const n=p.events[t].length;if("all"===s){for(let s=0;s<n;s++)c(e,t,p.events[t][s],o);return}for(let r=0;r<n;r++)if(e.removeEventListener&&p.events[t][r]===s){e.removeEventListener(t,s,m.supportsOptions?o:!!o.capture),p.events[t].splice(r,1);break}p.events[t]&&0===p.events[t].length&&(p.events[t]=null,p.typeCount--)}p.typeCount||(i.splice(l,1),r.splice(l,1))}else for(t in p.events)p.events.hasOwnProperty(t)&&c(e,t,"all")}function u(e,n){const r=f(n),i=new FakeEvent(e),p=l[e.type],[a]=o.getEventTargets(e);let c=a;for(;s.element(c);){for(let e=0;e<p.selectors.length;e++){const s=p.selectors[e],n=p.contexts[e];if(t.matchesSelector(c,s)&&t.nodeContains(n,a)&&t.nodeContains(n,c)){const t=p.listeners[e];i.currentTarget=c;for(const[e,s,n]of t)s===!!r.capture&&n===r.passive&&e(i)}}c=t.parentNode(c)}}function v(e){return u(e,!0)}function f(e){return s.object(e)?e:{capture:e}}export class FakeEvent{constructor(e){this.originalEvent=e,this.currentTarget=void 0,n(this,e)}preventOriginalDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.originalEvent.stopPropagation()}stopImmediatePropagation(){this.originalEvent.stopImmediatePropagation()}}const m={add:a,remove:c,addDelegate(e,t,s,n,o){const r=f(o);if(!l[s]){l[s]={contexts:[],listeners:[],selectors:[]};for(const e of p)a(e,s,u),a(e,s,v,!0)}const i=l[s];let c;for(c=i.selectors.length-1;c>=0&&(i.selectors[c]!==e||i.contexts[c]!==t);c--);-1===c&&(c=i.selectors.length,i.selectors.push(e),i.contexts.push(t),i.listeners.push([])),i.listeners[c].push([n,!!r.capture,r.passive])},removeDelegate(e,t,s,n,o){const r=f(o),i=l[s];let p,a=!1;if(i)for(p=i.selectors.length-1;p>=0;p--)if(i.selectors[p]===e&&i.contexts[p]===t){const e=i.listeners[p];for(let o=e.length-1;o>=0;o--){const[f,m,g]=e[o];if(f===n&&m===!!r.capture&&g===r.passive){e.splice(o,1),e.length||(i.selectors.splice(p,1),i.contexts.splice(p,1),i.listeners.splice(p,1),c(t,s,u),c(t,s,v,!0),i.selectors.length||(l[s]=null)),a=!0;break}}if(a)break}},delegateListener:u,delegateUseCapture:v,delegatedEvents:l,documents:p,supportsOptions:!1,supportsPassive:!1,_elements:r,_targets:i,init(e){e.document.createElement("div").addEventListener("test",null,{get capture(){return m.supportsOptions=!0},get passive(){return m.supportsPassive=!0}})}};export default m;
//# sourceMappingURL=events.min.js.map